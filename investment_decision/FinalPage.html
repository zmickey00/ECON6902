{{ block title }}
    Experiment Completed
{{ endblock }}

{{ block styles }}
<style>
    .otree-btn-next {
        background-color: #004080 !important;
        border-color: #004080 !important;
        color: #e0e0e0 !important;
    }

    .otree-btn-next:hover {
        background-color: #0055a5 !important;
        border-color: #0055a5 !important;
        color: #ffffff !important;
    }
    
    .completed-card {
        margin: 0 auto;
        margin-top: 50px;
    }
    
    .thank-you {
        text-align: center;
        margin: 40px 0;
    }
    
    .thank-you h2 {
        color: #004080;
        margin-bottom: 20px;
    }
    
    .thank-you p {
        font-size: 1.2rem;
        margin-bottom: 15px;
    }
    
    .total-earnings {
        background-color: #f0f7ff;
        border-left: 5px solid #28a745;
        padding: 20px;
        margin: 30px 0;
        text-align: center;
        border-radius: 5px;
    }
    
    .session-results {
        margin: 30px 0;
    }
    
    .session-item {
        background-color: #f8f9fa;
        padding: 15px;
        margin-bottom: 15px;
        border-radius: 5px;
        border-left: 4px solid #004080;
    }
    
    .session-item.selected {
        background-color: #f0fff0;
        border-left: 4px solid #28a745;
    }
    
    .session-item h5 {
        margin-bottom: 10px;
        color: #004080;
    }
    
    .session-item.selected h5 {
        color: #28a745;
    }
    
    .completed-icon {
        font-size: 4rem;
        color: #28a745;
        margin-bottom: 20px;
    }
    
    .selected-reward {
        text-align: center;
        margin: 20px 0;
        padding: 15px;
        background-color: #f0fff0;
        border-radius: 5px;
        border: 2px solid #28a745;
    }
    
    .selected-reward h4 {
        color: #28a745;
        margin-bottom: 10px;
    }
    
    .reward-calculation {
        margin: 20px auto;
        max-width: 350px;
    }
    
    .reward-table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .reward-table tr {
        border-bottom: 1px solid #e0e0e0;
    }
    
    .reward-table tr.total-row {
        border-top: 2px solid #28a745;
        border-bottom: none;
        font-weight: bold;
        font-size: 1.1em;
    }
    
    .reward-table td {
        padding: 8px 5px;
    }
    
    .reward-table td.amount {
        text-align: right;
        font-weight: bold;
    }
</style>
{{ endblock }}

{{ block content }}

<div class="card completed-card">
    <div class="card-header">
        <h3>Experiment Completed</h3>
    </div>
    <div class="card-body">
        <div class="thank-you">
            <div class="completed-icon">âœ“</div>
            <h2>Thank You for Participating!</h2>
            <p>You have successfully completed all four experiments.</p>
            <p>Your participation and decision-making have provided valuable data for our research.</p>
        </div>
        
        <div class="selected-reward">
            <h4>Your Reward</h4>
            <p>One of your experiment earnings has been randomly selected as your reward.</p>
            <div class="reward-calculation">
                <table class="reward-table">
                    <tr>
                        <td>Experiment Reward:</td>
                        <td class="amount">${{ selected_reward }}</td>
                    </tr>
                    <tr>
                        <td>Show-up Fee:</td>
                        <td class="amount">${{ show_up_fee }}</td>
                    </tr>
                    <tr class="total-row">
                        <td>Total Payment:</td>
                        <td class="amount">${{ total_payment }}</td>
                    </tr>
                </table>
            </div>
        </div>
        
        <div class="session-results">
            <h4>Results by Experiment:</h4>
            
            {% for result in session_results %}
            <div class="session-item {% if forloop.counter == selected_session %}selected{% endif %}">
                <h5>Experiment {{ result.session_num }} {% if forloop.counter == selected_session %}(Selected for Reward){% endif %}</h5>
                <p><strong>Total Return:</strong> ${{ result.total_return }}</p>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

{{ next_button }}

{{ endblock }}

{{ block scripts }}
<script>
    // This script is not necessary for the modification, but kept for potential future use
</script>
{{ endblock }}